<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>MediaManager</title>
</head>
<body>
    <div>
        <h2>Hello, World.</h2>
        <p id="summary">Loading...</p>
    </div>
    <div id="logged-in" style="display: none">
        You are logged in as <span id="login-name"></span>.
        <button id="log-out">Log out</button>
    </div>
    <div id="logged-out" style="display: none">
        You are not logged in.
        <button>Log in</button>
    </div>

    <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js"></script>
    <script src="//mediamanager.azure-mobile.net/client/MobileServices.Web-1.0.0.min.js"></script>
    <script type="text/javascript">
        var client = new WindowsAzure.MobileServiceClient(
            "https://mediamanager.azure-mobile.net/",
            "zXiNSblOtaOabAuuuuBrFgsqAugjWP23"
        );
        
        function refreshAuthDisplay() {
            var isLoggedIn = client.currentUser !== null;
            $("#logged-in").toggle(isLoggedIn);
            $("#logged-out").toggle(!isLoggedIn);

            if (isLoggedIn) {
                $("#login-name").text(client.currentUser.userId);
                //refreshTodoItems();
            }
        }

        function logIn() {
            client.login("twitter").then(refreshAuthDisplay, function (error) {
                alert(error);
            });
        }

        function logOut() {
            client.logout();
            refreshAuthDisplay();
            $('#summary').html('<strong>You must login to access data.</strong>');
        }

        // On page init, fetch the data and set up event handlers
        $(function () {
            refreshAuthDisplay();
            $('#summary').html('<strong>You must login to access data.</strong>');
            $("#logged-out button").click(logIn);
            $("#logged-in button").click(logOut);
        });
    </script>
</body>
</html>
